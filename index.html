<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>NYTSearch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<body>
    <center>
        <br><br><h1>NYT Search</h1>
        <div class="card" style="width: 32rem;"><div class="card-body"><div align="left">
        <br><h6>Search Term: </h6><input type="text" id="search_box" value=""><br><br>
        <h6>Start Year (Optional, in YYYYMMDD): </h6><input type="text" id="startdate_box" value=""><br><br>
        <h6>End Year (Optional, in YYYYMMDD): </h6><input type="text" id="enddate_box" value=""><br><br>
        <button id="submit" type="button" class="btn btn-primary">Submit</button><br><br>
        </div></div></div><br>
        <div id="display_results"></div>
        </div></div>
    </center>      
</body>
<script>
    $("#submit").on("click", function () {
    var url = [];
    url.push("https://api.nytimes.com/svc/search/v2/articlesearch.json?apikey=c2117551737444c0993461e828428e15");
    var search = ($("#search_box").val()).toLowerCase().replace(" ", "+");
    var startdate = ($("#startdate_box").val()).toLowerCase().replace(" ", "+");
    var enddate = ($("#enddate_box").val()).toLowerCase().replace(" ", "+");
    if (startdate) {
        url.push(("&start_date=" + startdate));
    }
    if (enddate) {
        url.push(("&end_date=" + enddate));
    }
    if (search) {
        url.push(("&q=" + search));
    };

    full_url = url.join('')
    console.log(full_url);

    $.ajax({
        url: full_url,
        method: 'GET',
    }).done(function (result) {
        var data_div = [];
        for (var i in result.response.docs){
            data_div.push("<h4>" + result.response.docs[i].snippet + "</h4>");
            data_div.push("<h5><a href='" + result.response.docs[i].web_url + "'>" + result.response.docs[i].web_url + "</h5></a>");
            data_div.push("<h6>Source: " + result.response.docs[i].source + "</h6>");
            data_div.push("<h6>" + result.response.docs[i].pub_date + "</h6><br>");
        };
       $("#display_results").html(data_div.join(''));
    });
    });
</script>
</html>
